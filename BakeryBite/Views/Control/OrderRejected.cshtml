@{
    ViewData["Title"] = "Отклоненные заказы";
    Layout = "_LayoutSecond";
}

<link rel="stylesheet" href="~/lib/bootstrap/dist/css/OrderEditor.css" />
@model List<BakeryBite.Models.Order>

<h1>Отклоненные заказы</h1>

<div class="order-buttons">
    <a asp-controller="Control" asp-action="OrderEditor" class="btn btn-primary">Не завершенные заказы</a>
    <a asp-controller="Control" asp-action="OrderConfirmed" class="btn btn-primary">Подтвержденные заказы</a>
    <a asp-controller="Control" asp-action="OrderRejected" class="btn btn-primary">Отклоненные заказы</a>
</div>

@if (Model != null && Model.Count > 0)
{
    <div class="order-list">
        @foreach (var order in Model)
        {
            <div class="order-item">
                <h2 class="order-title">Заказ # @order.Id</h2>
                <div class="details-row">
                    <div>
                        <p><strong>Дата заказа:</strong> @order.OrderDate</p>
                        <p><strong>Сумма заказа:</strong> @order.TotalAmount руб.</p>
                        <p>
                            <strong>Статус заказа:</strong>
                            @if (order.IsCompleted == 1)
                            {
                                <span class="status-completed">Оформлен</span>
                            }
                            else if (order.IsCompleted == 2)
                            {
                                <span class="status-rejected">Отклонен</span>
                            }
                            else
                            {
                                <span class="status-pending">Не завершен</span>
                            }
                        </p>
                        <p><strong>Способ оплаты:</strong> @order.PaymentMethod</p>
                    </div>
                    <div>
                        <p><strong>Адрес доставки:</strong> @order.Address</p>
                        <p><strong>Номер телефона:</strong> @order.Phone</p>
                        @{
                            string recipientName = string.Empty;
                            if (order.UserId.HasValue && order.User != null)
                            {
                                recipientName = $"{order.User.Surname} {order.User.Name} {order.User.Patronymic}";
                            }
                            else
                            {
                                recipientName = order.Name;
                            }
                        }
                        <p><strong>Получатель:</strong> @recipientName</p>
                        <p><strong>Подробнее:</strong> <a href="@Url.Action("OrderItems", "Control", new { orderId = order.Id })">Подробнее</a></p>
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <p>Нет отклоненных заказов.</p>
}
